
if [ -f /usr/share/xml/scap/ssg/content/ssg-centos7-ds.xml ]; then
        ds='centos7'
else   
	ds='rhel7'
fi

if [ ${ds} == "centos7" ]; then
	xccdf_profile=xccdf_org.ssgproject.content_profile_stig-rhel7-server-upstream
else
	xccdf_profile=xccdf_org.ssgproject.content_profile_stig-rhel7-disa
fi

mkdir -p /root/scap/{pre,post}/html
oscap xccdf eval --profile ${xccdf_profile} \
--report /root/scap/pre/html/report.html \
--results /root/scap/pre/html/results.xml \
/usr/share/xml/scap/ssg/content/ssg-${ds}-ds.xml

oscap xccdf generate fix \
--result-id xccdf_org.open-scap_testresult_${xccdf_profile} \
--template urn:xccdf:fix:script:sh \
/root/scap/pre/html/results.xml > /root/scap/pre/remediation-script.sh

chmod +x /root/scap/pre/remediation-script.sh
